{% extends 'base.html' %}

{% block title %}Serviços da API{% endblock %}

{% block content %}
<h2>Serviços importados da API</h2>
<table class="table table-striped table-bordered">
    <thead class="table-dark">
        <tr>
            <th>Data</th>
            <th>Talhão</th>
            <th>Produtos</th>
            <th>Trabalhadores</th>
            <th>Serviços Executados</th>
            <th>Valor Total (R$)</th>
            <th>Produtor</th>
        </tr>
    </thead>
    <tbody>
        {% for servico in servicos %}
        <tr>
            <!-- Data -->
            <td>{{ servico.data|date:"d/m/Y" }}</td>

            <!-- Talhão -->
            <td>{{ servico.talhao }}</td>

            <!-- Produtos -->
            <td>
                <ul class="mb-0">
                    {% for produto in servico.produtos %}
                        <li>
                            <strong>{{ produto.nome }}</strong><br>
                            Qtd: {{ produto.qtde }} {{ produto.unidade }}<br>
                            Valor: R$ {{ produto.valor }}
                        </li>
                    {% empty %}
                        <li>Nenhum</li>
                    {% endfor %}
                </ul>
            </td>

            <!-- Trabalhadores -->
            <td>
                <ul class="mb-0">
                    {% for trab in servico.trabalhadores %}
                        <li>{{ trab.nome }}</li>
                    {% empty %}
                        <li>Sem trabalhadores</li>
                    {% endfor %}
                </ul>
            </td>

            <!-- Serviços Executados -->
            <td>
                <ul class="mb-0">
                    {% for tipo in servico.servico_tipo %}
                        <li>{{ tipo|capfirst }}</li>
                    {% empty %}
                        <li>Sem serviços</li>
                    {% endfor %}
                </ul>
            </td>

            <!-- Valor total -->
            <td>R$ {{ servico.valor_servico }}</td>

            <!-- Produtor -->
            <td>{{ servico.proprietario.username }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="7">Nenhum serviço encontrado.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}
